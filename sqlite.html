<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css">
<link href="iThing.css" rel="stylesheet">
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
</head>
<body>

<div class="grid grid-pad">
   <div class="col-2-3">
     <div class="module">
		<div id="slider"></div>
		<div id="map"></div>
		<!-- <div id="googft-mapCanvas"></div> -->
     </div>
   </div>
   <div class="col-1-3">
     <div class="module">
     	<div id="info"></div>	
     </div>
   </div>
</div>

<script src="jquery-ui-1.10.4.custom/js/jquery-1.10.2.js"></script>
<script src="jquery-ui-1.10.4.custom/js/jquery-ui-1.10.4.custom.js"></script>
<script src="jQDateRangeSlider-min.js"></script>
<script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
<!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.2/handlebars.js"></script>
<script src="limabean.js"></script>

<!--
<script id="entry-template" type="text/x-handlebars-template">
  <div class="entry">
  {{#if material}}
	<h1>{{objectid}} {{material}}</h1>
  {{else}}
	<h1>{{objectid}}{{material}}</h1>
  {{/if}}
  </div>
</script> -->
	
<script type="text/javascript">
var udmap = udmap || {};
udmap.map = {};
udmap.info = {};
//handlebars style
udmap.info.style = {
	"color": "#ff7800",
	"weight": 5,
	"opacity": 0.65
};

/* var myStyle = {
	"color": "#ff7800",
	"weight": 5,
	"opacity": 0.65
}; */


//fires after DOM ready
$(function() {

udmap.map = L.map('map').setView([39.161944, -75.526667], 8);

//initialize jquery ui slider
$("#slider").dateRangeSlider({
    bounds: {min: new Date(2010,0), max: new Date(2014,4)},
    defaultValues: {min: new Date(2010,0), max: new Date(2014,4)},
	step:{months: 1},
	formatter:function(val){
        var days = val.getDate(),
          month = val.getMonth() + 1,
          year = val.getFullYear();
        return month + "/" + year;
      }
	});
		
//compiling handlebars
// var source = $("#entry-template").html();
// var template = Handlebars.compile(source);

function onEachFeature(feature, layer) {
	// add click handler to all features
	layer.on('click', function(e) {
		console.log(e.target);
		var html = template(e.target.feature.properties);
		$("#info").append(html);
	});
}

//local basemap tiles, currently generic world map
L.tileLayer('tiles/{z}/{x}/{y}.png', {
			minZoom: 5,
			maxZoom: 10,
			tms: true,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>'
		}).addTo(udmap.map);


L.geoJson(locality, {
	style: udmap.info.style,
	onEachFeature: onEachFeature
}).addTo(udmap.map);

});


/*		
var gjLayer = L.geoJson().addTo(map);


gjLayer.on('click', onMarkerClick);
		
for (var i = 0; i < locality.features.length; i++) {
gjfeature=locality.features[i].properties;
console.log(locality.features[i]);
gjLayer.addData(locality.features[i]);
L.geoJson(locality.features[i]).addTo(map);
 marker = L.marker([lat, lng]);
		marker.lbID = lbID;
		marker.on('click', onMarkerClick);
		marker.addTo(map);
} */
		
/* legacy code from GFT		
 
}
 function handler(response) {
	  //console.log(response);
      for (var i = 0; i < response.rows.length; i++) {
        var item = response.rows[i];
        // Either show the body or the automatic columns of the template
        /*if (item.toString()) {
          document.getElementById("info").innerHTML += "<br>" + item.toString();
        }  
		console.log(item[3]); /**//*
		lbID = item[0];		
		lat = item[1];
		lng = item[2];
		//lat = 39.6702;
		//lng = -75.7505;
		marker = L.marker([lat, lng]);
		marker.lbID = lbID;
		marker.on('click', onMarkerClick);
		marker.addTo(map);
      }
    } */
</script>

</body>
</html>
